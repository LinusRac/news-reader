<!-- Navigation Bar with Filtering -->
<app-navigation-bar 
  (categorySelected)="onCategorySelected($event)"
  (searchTextChanged)="onSearchTextChanged($event)"
  (createArticleClicked)="onCreateArticleClicked()">
</app-navigation-bar>

<div class="container main-content">
  <!-- Loading State -->
  <div *ngIf="isLoading" class="row">
    <div class="col-12 text-center py-5">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading articles...</span>
      </div>
      <p class="mt-3">Loading articles...</p>
    </div>
  </div>

  <!-- Error State -->
  <div *ngIf="errorMessage && !isLoading" class="row">
    <div class="col-12">
      <div class="alert alert-warning" role="alert">
        <i class="fas fa-exclamation-triangle me-2"></i>
        {{ errorMessage }}
        <button class="btn btn-outline-warning btn-sm ms-3" (click)="loadArticles()">
          <i class="fas fa-redo me-1"></i>Retry
        </button>
      </div>
    </div>
  </div>
  
  <!-- Articles Grid -->
  <div class="row">
    <div class="col-12">
      <div class="row" *ngIf="filteredArticles && filteredArticles.length > 0">
        <div class="col-lg-3 col-md-4 col-sm-6 mb-4" *ngFor="let article of filteredArticles">
          <div class="card h-100 article-card" 
               (mouseenter)="onMouseEnter($event)"
               (mouseleave)="onMouseLeave($event)">
            
            <!-- Image display - using thumbnail fields from list API -->
            <div *ngIf="article.thumbnail_image" class="article-image">
              <img [src]="'data:' + article.thumbnail_media_type + ';base64,' + article.thumbnail_image" 
                   [alt]="article.title" 
                   class="card-img-top"
                   style="height: 150px; object-fit: contain; width: 100%; background-color: #f8f9fa;">
            </div>
            
            
            <div class="card-body d-flex flex-column">
              <h5 class="card-title">{{ article.title }}</h5>
              <div class="card-text flex-grow-1" [innerHTML]="article.abstract"></div>
              <div class="mb-2">
                <span class="badge bg-primary">{{ article.category }}</span>
              </div>
              
              <!-- Action Buttons -->
              <div class="btn-group w-100" role="group">
                <button type="button" 
                        class="btn btn-outline-primary btn-sm" 
                        (click)="viewArticle(article.id)">
                  <i class="fas fa-eye me-1"></i>View
                </button>
                <button type="button" 
                        *ngIf="isLoggedIn()"
                        class="btn btn-outline-secondary btn-sm" 
                        (click)="editArticle(article.id)">
                  <i class="fas fa-edit me-1"></i>Edit
                </button>
                <button type="button" 
                        *ngIf="isLoggedIn()"
                        class="btn btn-outline-danger btn-sm" 
                        (click)="deleteArticle(article)">
                  <i class="fas fa-trash me-1"></i>Delete
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- No Articles Message -->
      <div class="row" *ngIf="!filteredArticles || filteredArticles.length === 0">
        <div class="col-12 text-center">
          <div class="alert alert-info">
            <h4>No articles found</h4>
            <p *ngIf="searchText || selectedCategory !== 'All'">
              No articles match your current filters. Try adjusting your search criteria.
            </p>
            <p *ngIf="!searchText && selectedCategory === 'All'">
              There are no articles to display. Create your first article to get started!
            </p>
            <button *ngIf="isLoggedIn()" class="btn btn-primary" (click)="onCreateArticleClicked()">
              <i class="fas fa-plus me-2"></i>Create First Article
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>